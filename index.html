<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script type="text/javascript" src="d3/d3.js"></script>
  <style>
    h2 {
      color: 'red';
      }
  </style>
  </head>


<body>
  <script type="text/javascript">
    function draw(data) {
        "use strict";

        var margin = 50,
            width = 500 - margin,
            height = 500 - margin;

        d3.select("body") // add a title
          .append('h2')
          .text("Test");

        var svg = d3.select("body")
            .append("svg")
            .attr("width", width + margin)
            .attr("height", height + margin);


        // create scales
        var xscale = d3.scalePoint()
          .domain(["propagule", "1st", "2nd", "3rd", "4th", "5th"])
          .range([margin, width]) // scale from margin to width
          .padding(0.2)
        var yscale = d3.scaleLog()
          .range([height, margin]) // (inverse) scale from height (bottom) to upper marginn
          .domain(d3.extent(data, function(d) {
            return d['Biovolume']
          }));

        // define axes
        var xaxis = d3.axisBottom(xscale);
        var yaxis = d3.axisLeft(yscale);

        // add axes to the svg element
        svg.append('g')
          .attr('class', 'x axis')
          .attr('transform', "translate(0," + height + ")")
          .call(xaxis);
        svg.append("text") //add title
          .attr('class', 'x title')
          .attr("text-anchor", "middle")
          .attr("transform", "translate("+ (width/2) + "," + (height + (margin/1.5)) +")")  // centre below axis
          .text('Host in cycle');

        svg.append('g')
          .attr('class', 'y axis')
          .attr('transform', "translate(" + margin + ",0)")
          .call(yaxis);
        svg.append('text')
          .attr('class', 'y title')
          .attr("text-anchor", "middle")
          .attr("transform", "translate("+ (margin/4) +","+(height/2)+")rotate(-90)")  
          .text('Biovolume');



        // plot points
        svg.selectAll("circle")
            .data(data)
            .enter()
            .append("circle")
            .attr('cx', function(d) {
              return xscale(d['Host.nofac']);
            })
            .attr('cy', function(d) {
              return yscale(d['Biovolume']); // need to filter out NaN values
            })
            .attr('r', 3)
            .attr('fill', 'blue')
            .attr('opacity', 0.1);

        } //end of draw function


  </script>

  <script type="text/javascript">
  /*
    Use D3 to load the GeoJSON file
    */

  d3.csv("data.csv", function(d) { //d refers to row in csv file
    d['maxLCL'] = +d['maxLCL']; // 'unary' operator converts strings to integer; Javscript trick
    d['Biovolume'] = +d['Biovolume'];
    return d;
  }, draw);
  </script>
</body>
</html>
